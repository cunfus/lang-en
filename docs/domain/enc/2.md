# 哈希函数

Hash Function，给任何值一个标识符。

## 安全属性

抗第一原像性：Pre-image Resistance，不能根据哈希函数的输出恢复对应的输入。（前提是，输入空间不能太小，且具有不可预测性。）

抗第一原像性：Second Pre-image Resistance，给定一个输入和一个哈希值，很难找到一个不同于该输入的新输入，使得它俩哈希值一样。

抗碰撞性：Collision Resistance，不能够产生女生哈希值相同的两个不同输入。


为了实现 128 bit 安全性这个最低的安全目标。

- 为了满足抗碰撞性，摘要长度至少是 256 bit
- 为了满足前两个性质，摘要长度至少是 128 bit

## 实际应用

资源完整性：通过 CDN 加载 JS 脚本，可以用哈希值核实是不是那个脚本，只有通过了验证，才能执行。

比特流：BitTorrent，Peer-to-Peer 分享文件，将文件切割成块，每块计算哈希值，所有块摘要生成一个新摘要作为 `magnet:xxx:hash`。

洋葱路由：Tor，验证隐藏网页的公钥，确定访问的网页是正确的。

## 标准化哈希函数

MD5 SHA-1，被证明是有缺陷的。

SHA-2：224，256，384，512（512/224，512/256），容易受到长度扩展攻击，不适合计算秘密消息的哈希值。

SHA-3：224，256，384，512，是推荐使用的哈希函数

SHAKE cSHAKE：基于 SHA-3，可扩展，可以输出任意长度。

元组哈希：TupleHash，基于 cSHAKE，对一组列表进行哈希。

口令哈希：Password Hashing，明文存储口令不安全，改为存储口令的哈希值。

- 通过加盐（salts），初始化哈希函数，让每个用户的口令计算函数不一样，避免在猜对一次的情况下，大规模攻破口令数据库。
- 用低运行速度口令算法，Argon2，防止被暴力破解。

