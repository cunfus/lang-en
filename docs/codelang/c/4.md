# 共享内存

## 共享文件映射

mmap，在调用进程的虚拟地址空间中创建一个新的内存映射，

文件映射，将文件的一部分映射到进程的虚拟内存。
匿名映射，没有对应文件,初始化长度为 0 的映射。

## 共享内存

【共享内存】，程序通过创建共享内存段，通过进程间通信（信号量），将该段的地址共享给其他进程。但需要保护这段内存不能被同时访问，需要信号量或者文件锁来同步。

共享内存段的位置，位于栈空间和堆空间之中，和链接动态库靠近，但两者不同，动态库的是链接进来的，只读分享数据和代码，不能修改。

共享内存有两套，分别是 System V 和 POSIX，不要混淆。
对 System V 来说，是一块内存区域附加到一个地址上，
`shmget shmat shmdt shmctl`

对 POSIX 来说，是一块内存区域被映射到一个地址，一般结合 mmap 使用。
`shm_open mmap shm_unlink`

`munmap mmap `或者 `mremap` 重建映射，可调大小。

